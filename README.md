A saída está apagando o arquivo de entrada e gerando um novo sem nada escrito em seu mesmo caminho.

Na especificação, pede que o nome da saída seja o mesmo do arquivo de entrada, e isso prevalece.

Precisa definir a função do processador de macros com os dados, para evoluir/melhorar/acertar o código da saída.

A função de entrada, acredito que seja isso. (Ela busca o arquivo a partir da entrada e imprime seus dados (com a evolução do trabalho, essa função não precisa existir, foi apenas colocada para testar se o input estava funcionando)
